apiVersion: apps/v1
kind: Deployment
metadata:
  name: pdd-dashboard-deployment
spec:
  replicas: 3
  strategy:
    type: RollingUpdate
    rollingUpdate:
      maxSurge: 1
      maxUnavailable: 0

  selector:
    matchLabels:
      app: pdd-dashboard

  template:
    metadata:
      labels:
        app: pdd-dashboard
    spec:
      containers:
        # --- EKS deployment: uncomment block below and comment the "Local" block when deploying to EKS ---
        # - name: pdd-dashboard-container
        #   image: <ACCOUNT_ID>.dkr.ecr.<REGION>.amazonaws.com/pdd-dashboard:1.0
        #   imagePullPolicy: Always
        #   ports:
        #     - containerPort: 8050
        #   livenessProbe:
        #     httpGet:
        #       path: /health/live
        #       port: 8050
        #     initialDelaySeconds: 10
        #     periodSeconds: 10
        #     timeoutSeconds: 5
        #     failureThreshold: 3
        #   readinessProbe:
        #     httpGet:
        #       path: /health/ready
        #       port: 8050
        #     initialDelaySeconds: 5
        #     periodSeconds: 5
        #     timeoutSeconds: 3
        #     failureThreshold: 2
        # --- Local / Minikube (comment this block when deploying to EKS) ---
        - name: pdd-dashboard-container
          image: pdd-dashboard:1.0
          imagePullPolicy: Never
          ports:
            - containerPort: 8050
          livenessProbe:
            httpGet:
              path: /health/live
              port: 8050
            initialDelaySeconds: 10
            periodSeconds: 10
            timeoutSeconds: 5
            failureThreshold: 3
          readinessProbe:
            httpGet:
              path: /health/ready
              port: 8050
            initialDelaySeconds: 5
            periodSeconds: 5
            timeoutSeconds: 3
            failureThreshold: 2
